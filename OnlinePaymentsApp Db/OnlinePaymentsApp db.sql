CREATE DATABASE [OnlinePaymentsAppDb]

GO
USE [OnlinePaymentsAppDb]
GO

CREATE TABLE [Users]
(
[UserId] INT PRIMARY KEY IDENTITY,
[Name] NVARCHAR(100) NOT NULL,
[Username] NVARCHAR(50) UNIQUE NOT NULL,
[Password] VARCHAR(256) NOT NULL
)


CREATE TABLE [Accounts]
(
[AccountId] INT PRIMARY KEY IDENTITY,
[AccountNumber] CHAR(22) UNIQUE NOT NULL,
[Balance] DECIMAL(18,2) NOT NULL CHECK (Balance >= 0)
)

CREATE TABLE [UserAccounts]
(
[UserId] INT NOT NULL,
[AccountId] INT NOT NULL,
PRIMARY KEY ([UserId], [AccountId]),
FOREIGN KEY ([UserId]) REFERENCES [Users]([UserId]),
FOREIGN KEY ([AccountId]) REFERENCES [Accounts]([AccountId])
)

CREATE TABLE [Payments]
(
[PaymentId] INT PRIMARY KEY IDENTITY,
[FromAccountId] INT FOREIGN KEY REFERENCES [Accounts]([AccountId]) NOT NULL,
[ToAccountNumber] CHAR(22) NOT NULL,
[Amount] DECIMAL(18,2) NOT NULL CHECK (Amount > 0),
[Reason] NVARCHAR(32) NOT NULL,
[Status] NVARCHAR(20) NOT NULL,
[CreatedAt] DATETIME NOT NULL,
[CreatedByUserId] INT FOREIGN KEY REFERENCES [Users]([UserId]) NOT NULL,
)

INSERT INTO [Users] ([Name], [Username], [Password]) VALUES
(N'Иван Петров',     'ivan.petrov',    'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Мария Георгиева', 'maria.georgieva',  'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Георги Иванов',   'georgi.ivanov', 'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Николай Димитров','niko.dimitrov',   'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Елена Стоянова',  'elena.stoyanova',  'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Михаил Динков', 'mihail.dinkov', 'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Анелия Пейчева', 'anelia.peycheva', 'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA'),
(N'Йоана Йорданова', 'yoana.yordanova', 'A109E36947AD56DE1DCA1CC49F0EF8AC9AD9A7B1AA0DF41FB3C4CB73C1FF01EA');

INSERT INTO [Accounts] ([AccountNumber], [Balance]) VALUES
('BG11AAAA11111111111111', 1200.00),
('BG22BBBB22222222222222', 500.00),
('BG33CCCC33333333333333', 750.55),
('BG44DDDD44444444444444', 3000.00),
('BG55EEEE55555555555555', 25.00),
('BG66FFFF66666666666666', 980.40);

INSERT INTO [UserAccounts] ([UserId], [AccountId]) VALUES
(1, 1),
(1, 2),
(2, 2),
(2, 3),
(3, 3),
(4, 4),
(4, 5),
(5, 6);